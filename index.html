<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Multimedia ‚Äì Social Scheduler (MVP)</title>

  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              DEFAULT: '#1e3a8a',
              50: '#eef2ff', 100: '#e0e7ff', 200: '#c7d2fe', 300: '#a5b4fc', 400: '#818cf8',
              500: '#6366f1', 600: '#4f46e5', 700: '#4338ca', 800: '#3730a3', 900: '#312e81'
            },
          },
          boxShadow: { soft: '0 10px 25px rgba(0,0,0,0.06)' },
          borderRadius: { xl2: '1.25rem' }
        }
      }
    }
  </script>

  <!-- React + ReactDOM (Production UMD) -->
  <script defer crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script defer crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- dayjs -->
  <script defer src="https://unpkg.com/dayjs@1/dayjs.min.js"></script>
  <script defer src="https://unpkg.com/dayjs@1/plugin/utc.js"></script>
  <script defer src="https://unpkg.com/dayjs@1/plugin/timezone.js"></script>

  <style>
    input[type="file"] { display: none; }
    .fade-enter-active { transition: all .25s ease; }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 selection:bg-primary-500 selection:text-white">
  <noscript>
    <div style="margin:16px;padding:12px;border:1px solid #fecaca;background:#fee2e2;color:#7f1d1d;border-radius:10px;">
      ÿ™ÿ≠ÿ™ÿßÿ¨ ŸÑÿ™ŸÅÿπŸäŸÑ JavaScript ŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ.
    </div>
  </noscript>

  <div id="root"></div>

  <script>
    // ÿ™ÿ¨ŸáŸäÿ≤ dayjs
    window.addEventListener('DOMContentLoaded', function () {
      try {
        dayjs.extend(window.dayjs_plugin_utc);
        dayjs.extend(window.dayjs_plugin_timezone);
      } catch (e) {
        // ÿπÿßÿØŸä ŸÑŸà ŸÖÿß ÿßÿ¥ÿ™ÿ∫ŸÑÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅÿßÿ™ÿå ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ŸäŸÉŸÖŸÑ
      }
    });

    // ÿ≥ÿ∑ÿ≠ ÿ£ÿÆÿ∑ÿßÿ° ÿ®ÿ≥Ÿäÿ∑ ÿ®ÿØŸÑ ÿßŸÑÿ¥ÿßÿ¥ÿ© ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°
    window.addEventListener('error', function(e){
      const el = document.getElementById('boot-error') || (() => {
        const b = document.createElement('div');
        b.id = 'boot-error';
        b.style.cssText = 'position:fixed;left:1rem;right:1rem;bottom:1rem;background:#fee2e2;color:#7f1d1d;border:1px solid #fecaca;padding:.75rem 1rem;border-radius:.75rem;font:12px system-ui,-apple-system,Segoe UI,Roboto;z-index:99999;';
        document.body.appendChild(b); return b;
      })();
      el.textContent = 'Runtime error: ' + (e.error && e.error.message ? e.error.message : e.message);
    });
  </script>

  <!-- ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ -->
  <script defer>
    ;(() => {
      const {useState, useEffect, useMemo, useRef} = React;

      // ŸÖŸÅÿßÿ™Ÿäÿ≠ ÿßŸÑÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑŸÖÿ≠ŸÑŸä
      const LS_KEYS = {
        POSTS: 'mm_scheduler_posts',
        ACCOUNTS: 'mm_scheduler_accounts',
        SETTINGS: 'mm_scheduler_settings'
      };
      const loadLS = (k, fallback) => { try { return JSON.parse(localStorage.getItem(k)) ?? fallback } catch { return fallback } }
      const saveLS = (k, v) => localStorage.setItem(k, JSON.stringify(v));

      // ÿßŸÑŸÖŸÜÿµÿßÿ™
      const PLATFORMS = [
        { key: 'instagram', name: 'Instagram', color: '#E1306C'},
        { key: 'facebook',  name: 'Facebook',  color: '#1877F2'},
        { key: 'x',         name: 'X (Twitter)', color: '#111111'},
        { key: 'linkedin',  name: 'LinkedIn',  color: '#0a66c2'},
        { key: 'tiktok',    name: 'TikTok',    color: '#000000'},
      ];

      // Toasts
      function useToast() {
        const [toasts, setToasts] = useState([]);
        function push(msg, type = 'info') {
          const id = Math.random().toString(36).slice(2);
          setToasts(t => [...t, {id, msg, type}]);
          setTimeout(() => setToasts(t => t.filter(x => x.id !== id)), 3000);
        }
        return { toasts, push };
      }
      function Toasts({items}){
        return (
          React.createElement('div', {className:'fixed bottom-4 right-4 space-y-2 z-50'},
            items.map(t =>
              React.createElement('div', {
                key: t.id,
                className: `fade-enter-active px-4 py-2 rounded-xl2 shadow-soft text-white ${
                  t.type==='success' ? 'bg-emerald-600' : t.type==='error' ? 'bg-rose-600' : 'bg-slate-900'
                }`
              }, t.msg)
            )
          )
        )
      }

      const Badge = ({children, color="bg-slate-100 text-slate-700"}) =>
        React.createElement('span', {className:`inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium ${color}`}, children);

      function Nav({tab, setTab}){
        const tabs = [
          {id:'compose', label:'ÿ•ŸÜÿ¥ÿßÿ° ŸÖŸÜÿ¥Ÿàÿ±'},
          {id:'calendar', label:'ÿßŸÑÿ™ŸÇŸàŸäŸÖ'},
          {id:'accounts', label:'ÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™'},
          {id:'library', label:'ŸÖŸÉÿ™ÿ®ÿ© ÿßŸÑŸàÿ≥ÿßÿ¶ÿ∑'},
          {id:'settings', label:'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™'},
        ];
        return (
          React.createElement('header', {className:'sticky top-0 z-30 bg-white/80 backdrop-blur border-b border-slate-200'},
            React.createElement('div', {className:'max-w-6xl mx-auto px-4'},
              React.createElement('div', {className:'flex items-center gap-4 h-16'},
                React.createElement('div', {className:'flex items-center gap-3'},
                  React.createElement('div', {className:'w-9 h-9 rounded-xl2 bg-primary-600 grid place-items-center text-white font-bold'}, 'MM'),
                  React.createElement('div', null,
                    React.createElement('h1', {className:'text-lg font-semibold'}, 'Multimedia Scheduler'),
                    React.createElement('p', {className:'text-xs text-slate-500'}, 'MVP Ÿàÿßÿ¨Ÿáÿ© ÿ£ŸÖÿßŸÖŸäÿ© ‚Äì ÿ¨ÿØŸàŸÑÿ© ŸÖÿ™ÿπÿØÿØÿ© ÿßŸÑŸÖŸÜÿµÿßÿ™')
                  )
                ),
                React.createElement('nav', {className:'ms-auto flex items-center gap-1'},
                  tabs.map(t => React.createElement('button', {
                    key:t.id,
                    onClick:()=>setTab(t.id),
                    className:`px-3 py-2 rounded-lg text-sm font-medium transition ${tab===t.id? 'bg-primary-600 text-white' : 'hover:bg-slate-100'}`
                  }, t.label))
                )
              )
            )
          )
        )
      }

      function MediaLibrary({media, setMedia}){
        const fileInputRef = useRef(null);
        function onSelect(e){
          const files = Array.from(e.target.files || []);
          const mapped = files.map(f => ({
            id: Math.random().toString(36).slice(2),
            name: f.name, type: f.type, size: f.size,
            url: URL.createObjectURL(f)
          }));
          setMedia(prev => [...mapped, ...prev]);
        }
        function remove(id){ setMedia(prev => prev.filter(m => m.id !== id)); }
        return (
          React.createElement('section', {className:'max-w-6xl mx-auto px-4 py-6'},
            React.createElement('div', {className:'bg-white rounded-2xl shadow-soft p-5'},
              React.createElement('div', {className:'flex items-center justify-between mb-4'},
                React.createElement('h2', {className:'text-lg font-semibold'}, 'ŸÖŸÉÿ™ÿ®ÿ© ÿßŸÑŸàÿ≥ÿßÿ¶ÿ∑ (ŸÖÿ≠ŸÑŸëŸä)'),
                React.createElement('div', {className:'flex items-center gap-2'},
                  React.createElement('label', {className:'inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-900 text-white cursor-pointer'},
                    React.createElement('span', null, 'ÿ±ŸÅÿπ ŸÖŸÑŸÅÿßÿ™'),
                    React.createElement('input', {ref:fileInputRef, type:'file', multiple:true, accept:'image/*,video/*', onChange:onSelect})
                  ),
                  React.createElement('button', {onClick:()=>setMedia([]), className:'px-3 py-2 rounded-lg bg-rose-50 text-rose-700 hover:bg-rose-100'}, 'ÿ™ŸÅÿ±Ÿäÿ∫')
                )
              ),
              media.length === 0
                ? React.createElement('p', {className:'text-slate-500'}, 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÑŸÅÿßÿ™ ŸÖÿ±ŸÅŸàÿπÿ© ÿ®ÿπÿØ. ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿ≤ÿ± "ÿ±ŸÅÿπ ŸÖŸÑŸÅÿßÿ™".')
                : React.createElement('ul', {className:'grid md:grid-cols-4 sm:grid-cols-2 gap-4'},
                    media.map(m => React.createElement('li', {key:m.id, className:'border border-slate-200 rounded-xl overflow-hidden'},
                      m.type.startsWith('image')
                        ? React.createElement('img', {src:m.url, alt:m.name, className:'w-full h-40 object-cover'})
                        : React.createElement('video', {src:m.url, controls:true, className:'w-full h-40 object-cover'}),
                      React.createElement('div', {className:'p-2 text-xs flex items-center justify-between'},
                        React.createElement('span', {className:'truncate', title:m.name}, m.name),
                        React.createElement('button', {onClick:()=>remove(m.id), className:'text-rose-600 hover:underline'}, 'ÿ≠ÿ∞ŸÅ')
                      )
                    ))
                  )
            )
          )
        )
      }

      function Accounts({accounts, setAccounts, toast}){
        function connect(platform){
          const id = Math.random().toString(36).slice(2);
          const display = prompt(`ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿπÿ±ÿ∂ ŸÑŸÑÿ≠ÿ≥ÿßÿ® (${platform})\nŸÖÿ´ÿßŸÑ: Multimedia KSA`);
          if(!display) return;
          const acc = { id, platform, display, createdAt: new Date().toISOString(), meta: { note: 'OAuth Ÿäÿ™ŸÖ ÿπÿ®ÿ± ÿßŸÑÿ®ÿßŸÉ-ÿ•ŸÜÿØ' } };
          const next = [...accounts, acc];
          setAccounts(next); saveLS(LS_KEYS.ACCOUNTS, next);
          toast.push('ÿ™ŸÖÿ™ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ≠ÿ≥ÿßÿ® (Placeholder). ŸàÿµŸëŸÑ OAuth ŸÑÿßÿ≠ŸÇÿßŸã.', 'success');
        }
        function remove(id){
          if(!confirm('ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ≠ÿ≥ÿßÿ® ŸÖŸÜ ÿßŸÑŸàÿßÿ¨Ÿáÿ©ÿü')) return;
          const next = accounts.filter(a => a.id !== id);
          setAccounts(next); saveLS(LS_KEYS.ACCOUNTS, next);
          toast.push('ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ≠ÿ≥ÿßÿ® (ŸÖÿ≠ŸÑŸäÿßŸã).');
        }
        return (
          React.createElement('section', {className:'max-w-6xl mx-auto px-4 py-6'},
            React.createElement('div', {className:'bg-white rounded-2xl shadow-soft p-5'},
              React.createElement('div', {className:'flex items-center justify-between mb-4'},
                React.createElement('h2', {className:'text-lg font-semibold'}, 'ÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™ ÿßŸÑŸÖÿ™ÿµŸÑÿ©'),
                React.createElement('div', {className:'flex flex-wrap gap-2'},
                  PLATFORMS.map(p => React.createElement('button', {
                    key:p.key, onClick:()=>connect(p.key),
                    className:'px-3 py-2 rounded-lg bg-slate-900 text-white hover:opacity-90'
                  }, `ÿ±ÿ®ÿ∑ ${p.name}`))
                )
              ),
              accounts.length === 0
                ? React.createElement('p', {className:'text-slate-500'}, 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ≠ÿ≥ÿßÿ®ÿßÿ™ ÿ®ÿπÿØ. ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿ£ÿ≤ÿ±ÿßÿ± "ÿ±ÿ®ÿ∑". ÿ≥Ÿäÿ™ŸÖ ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑ Ÿáÿ∞Ÿá ÿßŸÑÿÆÿ∑Ÿàÿ© ÿ®ÿ™ÿØŸÅŸÇ OAuth ÿπÿ®ÿ± ÿßŸÑÿ®ÿßŸÉ-ÿ•ŸÜÿØ.')
                : React.createElement('ul', {className:'divide-y divide-slate-200'},
                    accounts.map(a =>
                      React.createElement('li', {key:a.id, className:'py-3 flex items-center gap-3'},
                        React.createElement('div', {
                          className:'w-9 h-9 rounded-xl2',
                          style:`background:${a.platform==='instagram'?'#E1306C':a.platform==='facebook'?'#1877F2':a.platform==='linkedin'?'#0a66c2':'#111'}`
                        }),
                        React.createElement('div', {className:'flex-1'},
                          React.createElement('div', {className:'font-medium'}, a.display),
                          React.createElement('div', {className:'text-xs text-slate-500'}, `${a.platform} ‚Ä¢ ÿ£ÿ∂ŸäŸÅ ${dayjs(a.createdAt).format('YYYY/MM/DD HH:mm')}`)
                        ),
                        React.createElement('button', {onClick:()=>remove(a.id), className:'px-2.5 py-1.5 rounded bg-rose-50 text-rose-700'}, 'ÿ•ÿ≤ÿßŸÑÿ©')
                      )
                    )
                  )
            ),
            React.createElement('div', {className:'mt-4 text-xs text-slate-500 bg-amber-50 border border-amber-200 rounded-xl p-3'},
              'ŸÖŸÑÿßÿ≠ÿ∏ÿ©: ÿπŸÜÿØ ÿ®ŸÜÿßÿ° ÿßŸÑÿ®ÿßŸÉ-ÿ•ŸÜÿØÿå ÿßÿ≥ÿ™ÿ®ÿØŸÑ ÿ≤ÿ± "ÿ±ÿ®ÿ∑" ÿ®ÿ•ÿπÿßÿØÿ© ÿ™Ÿàÿ¨ŸäŸá ÿ•ŸÑŸâ ŸÖÿ≥ÿßÿ± OAuth ŸÖÿ´ŸÑ: ',
              React.createElement('code', null, '/api/oauth/:platform/auth'),
              ' ÿ´ŸÖ ÿÆÿ≤ŸêŸëŸÜ account_id Ÿà access_token ŸÅŸä ÿßŸÑÿÆÿßÿØŸÖ.'
            )
          )
        )
      }

      function Compose({accounts, mediaLibrary, addPost, toast}){
        const [text, setText] = useState('');
        const [selectedMedia, setSelectedMedia] = useState([]);
        const [targets, setTargets] = useState([]);
        const [when, setWhen] = useState(() => (window.dayjs||dayjs)().add(1,'hour').format('YYYY-MM-DDTHH:mm'));

        const totalChars = text.length;
        const xLimit = 280;
        const xOver = Math.max(0, totalChars - xLimit);

        function toggleTarget(id){ setTargets(t => t.includes(id) ? t.filter(x=>x!==id) : [...t, id]); }
        function toggleMedia(id){ setSelectedMedia(s => s.includes(id) ? s.filter(x=>x!==id) : [...s,id]); }

        function schedule(){
          if(!targets.length){ toast.push('ÿßÿÆÿ™ÿ± ÿ≠ÿ≥ÿßÿ®/ÿ≠ÿ≥ÿßÿ®ÿßÿ™ ŸÑŸÑŸÜÿ¥ÿ±', 'error'); return; }
          const whenISO = (window.dayjs||dayjs)(when).toISOString();
          const post = {
            id: Math.random().toString(36).slice(2),
            text,
            media: selectedMedia.map(id => mediaLibrary.find(m => m.id===id)).filter(Boolean),
            targets,
            scheduledAt: whenISO,
            status: 'scheduled',
            createdAt: new Date().toISOString()
          };
          addPost(post);
          setText(''); setSelectedMedia([]);
          toast.push('ÿ™ŸÖÿ™ ÿ¨ÿØŸàŸÑÿ© ÿßŸÑŸÖŸÜÿ¥Ÿàÿ±', 'success');
        }

        return (
          React.createElement('section', {className:'max-w-6xl mx-auto px-4 py-6'},
            React.createElement('div', {className:'grid lg:grid-cols-3 gap-5'},
              React.createElement('div', {className:'lg:col-span-2 bg-white rounded-2xl shadow-soft p-5'},
                React.createElement('h2', {className:'text-lg font-semibold mb-4'}, 'ŸÖÿ≠ÿ±ÿ± ÿßŸÑŸÖŸÜÿ¥Ÿàÿ±'),
                React.createElement('textarea', {
                  value:text, onChange:e=>setText(e.target.value), placeholder:'ŸÜÿµ ÿßŸÑŸÖŸÜÿ¥Ÿàÿ±...',
                  className:'w-full min-h-[140px] rounded-xl border border-slate-200 p-3 focus:outline-none focus:ring-2 focus:ring-primary-500'
                }),
                React.createElement('div', {className:'flex flex-wrap items-center gap-2 mt-3'},
                  React.createElement('div', {className:`text-xs ${xOver>0? 'text-rose-600' : 'text-slate-500'}`},
                    `ÿ£ÿ≠ÿ±ŸÅ: ${totalChars}${xOver>0 ? ` (+${xOver} ŸÅŸàŸÇ ÿ≠ÿØ X)` : ''}`
                  ),
                  React.createElement(Badge, null, `üñºÔ∏è Ÿàÿ≥ÿßÿ¶ÿ∑ ŸÖÿÆÿ™ÿßÿ±ÿ©: ${selectedMedia.length}`),
                  React.createElement(Badge, null, `üéØ ÿ≠ÿ≥ÿßÿ®ÿßÿ™: ${targets.length}`),
                  React.createElement('div', {className:'ms-auto flex items-center gap-2'},
                    React.createElement('input', {type:'datetime-local', value:when, onChange:e=>setWhen(e.target.value),
                      className:'rounded-lg border border-slate-300 px-2 py-1'}),
                    React.createElement('button', {onClick:schedule, className:'px-4 py-2 rounded-xl2 bg-primary-600 text-white hover:bg-primary-700'}, 'ÿ¨ÿØŸàŸÑÿ©')
                  )
                ),
                React.createElement('div', {className:'mt-5'},
                  React.createElement('h3', {className:'font-medium mb-2'}, 'ÿßÿÆÿ™ÿ± Ÿàÿ≥ÿßÿ¶ÿ∑ ŸÖŸÜ ÿßŸÑŸÖŸÉÿ™ÿ®ÿ©'),
                  mediaLibrary.length === 0
                    ? React.createElement('p', {className:'text-sm text-slate-500'}, 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ Ÿàÿ≥ÿßÿ¶ÿ∑. ÿßÿ±ŸÅÿπ ŸÖŸÜ ÿ™ÿ®ŸàŸäÿ® "ŸÖŸÉÿ™ÿ®ÿ© ÿßŸÑŸàÿ≥ÿßÿ¶ÿ∑".')
                    : React.createElement('ul', {className:'grid md:grid-cols-4 sm:grid-cols-2 gap-3'},
                        mediaLibrary.map(m =>
                          React.createElement('li', {key:m.id, className:`relative border rounded-xl overflow-hidden ${selectedMedia.includes(m.id)?'ring-2 ring-primary-500':''}`},
                            m.type.startsWith('image')
                              ? React.createElement('img', {src:m.url, alt:m.name, className:'w-full h-32 object-cover'})
                              : React.createElement('video', {src:m.url, className:'w-full h-32 object-cover'}),
                            React.createElement('label', {className:'absolute top-2 right-2 bg-white/90 rounded-md px-2 py-1 text-xs cursor-pointer shadow', title:'ÿßÿÆÿ™ÿ±'},
                              React.createElement('input', {type:'checkbox', className:'mr-1', checked:selectedMedia.includes(m.id), onChange:()=>toggleMedia(m.id)}),
                              ' Ÿàÿ≥ÿßÿ¶ÿ∑'
                            )
                          )
                        )
                      )
                )
              ),
              React.createElement('aside', {className:'bg-white rounded-2xl shadow-soft p-5'},
                React.createElement('h3', {className:'font-semibold mb-3'}, 'ÿßÿÆÿ™ÿ± ÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅÿ©'),
                accounts.length===0
                  ? React.createElement('p', {className:'text-sm text-slate-500'}, 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ≠ÿ≥ÿßÿ®ÿßÿ™. ÿ£ÿ∂ŸÅ ŸÖŸÜ ÿ™ÿ®ŸàŸäÿ® "ÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™".')
                  : React.createElement('ul', {className:'space-y-2'},
                      accounts.map(a =>
                        React.createElement('li', {key:a.id, className:'flex items-center gap-2'},
                          React.createElement('input', {id:`acc-${a.id}`, type:'checkbox', checked:targets.includes(a.id), onChange:()=>toggleTarget(a.id)}),
                          React.createElement('label', {htmlFor:`acc-${a.id}`, className:'cursor-pointer'},
                            `${a.display} `,
                            React.createElement('span', {className:'text-xs text-slate-500'}, `(${a.platform})`)
                          )
                        )
                      )
                    ),
                React.createElement('div', {className:'mt-6 pt-4 border-t'},
                  React.createElement('h4', {className:'font-medium mb-2'}, 'ŸÖÿπÿßŸäŸÜÿ© ÿ≥ÿ±Ÿäÿπÿ© (ÿ™ŸÇÿ±Ÿäÿ®Ÿäÿ©)'),
                  React.createElement('div', {className:'text-xs text-slate-600 space-y-2'},
                    React.createElement('div', {className:'p-3 rounded-lg bg-slate-50 border'}, `X: ${Math.min(totalChars, xLimit)} / ${xLimit} ${xOver>0? '(ÿ≥Ÿäÿ™ŸÖ ŸÇÿµ ÿßŸÑÿ≤ÿßÿ¶ÿØ)' : ''}`),
                    React.createElement('div', {className:'p-3 rounded-lg bg-slate-50 border'}, 'Instagram/Facebook/LinkedIn: ŸäÿØÿπŸÖ ŸÜÿµŸàÿµ ÿ∑ŸàŸäŸÑÿ© ŸàÿµŸàÿ±/ŸÅŸäÿØŸäŸà'),
                    React.createElement('div', {className:'p-3 rounded-lg bg-slate-50 border'}, 'TikTok: ÿßŸÑÿ£ŸÅÿ∂ŸÑ ŸÅŸäÿØŸäŸà ÿπŸÖŸàÿØŸä')
                  )
                )
              )
            )
          )
        )
      }

      function CalendarView({posts, updatePost, deletePost}){
        const grouped = useMemo(() => {
          const by = {};
          posts.forEach(p => {
            const d = dayjs(p.scheduledAt).format('YYYY-MM-DD');
            by[d] = by[d] || []; by[d].push(p);
          });
          Object.values(by).forEach(arr => arr.sort((a,b)=> new Date(a.scheduledAt)-new Date(b.scheduledAt)));
          return Object.keys(by).sort().map(k => ({date:k, items:by[k]}));
        }, [posts]);

        return (
          React.createElement('section', {className:'max-w-6xl mx-auto px-4 py-6'},
            React.createElement('div', {className:'bg-white rounded-2xl shadow-soft p-5'},
              React.createElement('h2', {className:'text-lg font-semibold mb-4'}, 'ÿßŸÑÿ™ŸÇŸàŸäŸÖ / ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖÿ¨ÿØŸàŸÑ'),
              grouped.length===0
                ? React.createElement('p', {className:'text-slate-500'}, 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ¥Ÿàÿ±ÿßÿ™ ŸÖÿ¨ÿØŸàŸÑÿ©.')
                : grouped.map(g =>
                    React.createElement('div', {key:g.date, className:'mb-6'},
                      React.createElement('h3', {className:'font-medium text-slate-700 mb-2'}, dayjs(g.date).format('dddd YYYY/MM/DD')),
                      React.createElement('ul', {className:'space-y-3'},
                        g.items.map(p =>
                          React.createElement('li', {key:p.id, className:'border border-slate-200 rounded-xl p-3'},
                            React.createElement('div', {className:'flex items-center gap-2 text-sm text-slate-600 mb-2'},
                              React.createElement(Badge, {color:'bg-emerald-50 text-emerald-700'}, p.status),
                              React.createElement('span', null, '‚è∞ ' + dayjs(p.scheduledAt).format('HH:mm')),
                              React.createElement('span', null, 'üéØ ' + p.targets.length + ' ÿ≠ÿ≥ÿßÿ®'),
                              React.createElement('span', null, 'üñºÔ∏è ' + p.media.length + ' Ÿàÿ≥ÿßÿ¶ÿ∑')
                            ),
                            React.createElement('div', {className:'text-sm whitespace-pre-wrap'}, p.text || '‚Äî ÿ®ÿØŸàŸÜ ŸÜÿµ ‚Äî'),
                            p.media.length>0 && React.createElement('div', {className:'mt-2 grid grid-cols-3 gap-2'},
                              p.media.slice(0,3).map((m,i)=>
                                React.createElement('div', {key:i, className:'aspect-video overflow-hidden rounded-lg border'},
                                  m.type.startsWith('image')
                                    ? React.createElement('img', {src:m.url, alt:m.name, className:'w-full h-full object-cover'})
                                    : React.createElement('video', {src:m.url, className:'w-full h-full object-cover'})
                                )
                              )
                            ),
                            React.createElement('div', {className:'mt-3 flex items-center gap-2'},
                              React.createElement('button', {onClick:()=>{
                                const when = prompt('ÿ™ÿßÿ±ŸäÿÆ/ŸàŸÇÿ™ ÿ¨ÿØŸäÿØ (YYYY-MM-DDTHH:mm):', dayjs(p.scheduledAt).format('YYYY-MM-DDTHH:mm'));
                                if(!when) return;
                                updatePost({...p, scheduledAt: dayjs(when).toISOString()});
                              }, className:'px-3 py-1.5 rounded bg-slate-900 text-white'}, 'ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸàŸÇÿ™'),
                              React.createElement('button', {onClick:()=>deletePost(p.id), className:'px-3 py-1.5 rounded bg-rose-50 text-rose-700'}, 'ÿ≠ÿ∞ŸÅ')
                            )
                          )
                        )
                      )
                    )
                  )
            )
          )
        )
      }

      function Settings({settings, setSettings, posts, accounts, setPosts, setAccounts, toast}){
        const fileRef = useRef(null);
        function save(){ saveLS(LS_KEYS.SETTINGS, settings); toast.push('ÿ™ŸÖ ÿßŸÑÿ≠ŸÅÿ∏', 'success'); }
        function exportJSON(){
          const blob = new Blob([JSON.stringify({posts, accounts, settings}, null, 2)], {type:'application/json'});
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = `scheduler_export_${Date.now()}.json`; a.click();
          URL.revokeObjectURL(url);
        }
        function onImport(e){
          const f = e.target.files?.[0]; if(!f) return;
          const reader = new FileReader();
          reader.onload = () => {
            try {
              const data = JSON.parse(reader.result);
              if(data.posts) { setPosts(data.posts); saveLS(LS_KEYS.POSTS, data.posts); }
              if(data.accounts) { setAccounts(data.accounts); saveLS(LS_KEYS.ACCOUNTS, data.accounts); }
              if(data.settings) { setSettings(data.settings); saveLS(LS_KEYS.SETTINGS, data.settings); }
              toast.push('ÿ™ŸÖ ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ', 'success');
            } catch(err){ toast.push('ŸÅÿ¥ŸÑ ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ: ÿµŸäÿ∫ÿ© ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©', 'error'); }
          }
          reader.readAsText(f);
        }
        return (
          React.createElement('section', {className:'max-w-6xl mx-auto px-4 py-6'},
            React.createElement('div', {className:'bg-white rounded-2xl shadow-soft p-5 space-y-6'},
              React.createElement('div', null,
                React.createElement('h2', {className:'text-lg font-semibold mb-2'}, 'ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸàÿßÿ¨Ÿáÿ©'),
                React.createElement('div', {className:'grid sm:grid-cols-2 gap-4'},
                  React.createElement('label', {className:'block'},
                    React.createElement('div', {className:'text-sm text-slate-600 mb-1'}, 'ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ≤ŸÖŸÜŸäÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©'),
                    React.createElement('input', {
                      value: settings.tz || '',
                      onChange: e=>setSettings({...settings, tz:e.target.value}),
                      placeholder:'Asia/Riyadh', className:'w-full rounded-lg border border-slate-300 px-3 py-2'
                    })
                  ),
                  React.createElement('label', {className:'block'},
                    React.createElement('div', {className:'text-sm text-slate-600 mb-1'}, 'API Base URL (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)'),
                    React.createElement('input', {
                      value: settings.api || '',
                      onChange: e=>setSettings({...settings, api:e.target.value}),
                      placeholder:'https://api.yourdomain.com', className:'w-full rounded-lg border border-slate-300 px-3 py-2'
                    })
                  ),
                ),
                React.createElement('div', {className:'mt-3'},
                  React.createElement('button', {onClick:save, className:'px-4 py-2 rounded-xl2 bg-primary-600 text-white'}, 'ÿ≠ŸÅÿ∏')
                )
              ),
              React.createElement('div', {className:'border-t pt-4'},
                React.createElement('h3', {className:'font-medium mb-2'}, 'ŸÜÿ≥ÿÆ ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä'),
                React.createElement('div', {className:'flex items-center gap-2'},
                  React.createElement('button', {onClick:exportJSON, className:'px-3 py-2 rounded-lg bg-slate-900 text-white'}, 'ÿ™ÿµÿØŸäÿ± JSON'),
                  React.createElement('label', {className:'px-3 py-2 rounded-lg bg-slate-100 cursor-pointer'}, 'ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ JSON',
                    React.createElement('input', {ref:fileRef, type:'file', accept:'application/json', onChange:onImport})
                  ),
                  React.createElement('button', {onClick:()=>{
                    if(confirm('ŸÖÿ≥ÿ≠ ŸÉŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≠ŸÑŸäÿ©ÿü')){
                      setPosts([]); setAccounts([]);
                      saveLS(LS_KEYS.POSTS, []); saveLS(LS_KEYS.ACCOUNTS, []);
                    }
                  }, className:'px-3 py-2 rounded-lg bg-rose-50 text-rose-700'}, 'ÿ™ŸÅÿ±Ÿäÿ∫ ŸÖÿ≠ŸÑŸä')
                )
              ),
              React.createElement('div', {className:'text-xs text-slate-500 bg-amber-50 border border-amber-200 rounded-xl p-3'},
                'ŸÑŸÑÿ™ŸÉÿßŸÖŸÑ ÿßŸÑÿ≠ŸÇŸäŸÇŸä: ÿßÿ±ÿ®ÿ∑ Ÿáÿ∞Ÿá ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿ®ÿ®ÿßŸÉ-ÿ•ŸÜÿØ ŸäŸÇŸàŸÖ ÿ®ŸÄOAuth Ÿàÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑÿ™ŸàŸÉŸÜÿßÿ™ Ÿàÿ¨ÿØŸàŸÑÿ© ÿßŸÑŸÖŸáÿßŸÖ ŸàŸÜÿ¥ÿ±Ÿáÿß ÿπÿ®ÿ± Workers. ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿ≠ÿßŸÑŸäÿßŸã ŸÖÿ≠ŸÑŸäÿ© (LocalStorage).'
              )
            )
          )
        )
      }

      function App(){
        const [tab, setTab] = useState('compose');
        const [posts, setPosts] = useState(() => loadLS(LS_KEYS.POSTS, []));
        const [accounts, setAccounts] = useState(() => loadLS(LS_KEYS.ACCOUNTS, []));
        const [media, setMedia] = useState([]);
        const [settings, setSettings] = useState(() => loadLS(LS_KEYS.SETTINGS, { tz: 'Asia/Riyadh', api: '' }));
        const toast = useToast();

        useEffect(()=>{ saveLS(LS_KEYS.POSTS, posts); }, [posts]);

        function addPost(p){ setPosts(prev => [...prev, p]); }
        function updatePost(p){ setPosts(prev => prev.map(x => x.id===p.id ? p : x)); }
        function deletePost(id){ setPosts(prev => prev.filter(x => x.id!==id)); }

        // ŸÖŸèÿ≠ÿßŸÉŸä ŸÜÿ¥ÿ± ŸÖÿ≠ŸÑŸä
        useEffect(()=>{
          const t = setInterval(() => {
            setPosts(prev => prev.map(p => {
              if(p.status==='scheduled' && dayjs().isAfter(dayjs(p.scheduledAt))) {
                return { ...p, status: 'published', publishedAt: new Date().toISOString() };
              }
              return p;
            }));
          }, 15000);
          return () => clearInterval(t);
        }, []);

        return (
          React.createElement('div', null,
            React.createElement(Nav, {tab, setTab}),
            tab==='compose' && React.createElement(Compose, {accounts, mediaLibrary:media, addPost, toast}),
            tab==='calendar' && React.createElement(CalendarView, {posts, updatePost, deletePost}),
            tab==='accounts' && React.createElement(Accounts, {accounts, setAccounts, toast}),
            tab==='library' && React.createElement(MediaLibrary, {media, setMedia}),
            tab==='settings' && React.createElement(Settings, {settings, setSettings, posts, accounts, setPosts, setAccounts, toast}),
            React.createElement(Toasts, {items:toast.toasts}),
            React.createElement('footer', {className:'max-w-6xl mx-auto px-4 py-8 text-center text-xs text-slate-500'},
              `¬© ${new Date().getFullYear()} Multimedia. Ÿàÿßÿ¨Ÿáÿ© MVP ŸÑŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿØÿßÿÆŸÑŸä ‚Äì ÿ¨ÿØŸàŸÑÿ© ŸÖÿ≠ŸÑŸäŸëÿ©. ÿßÿ±ÿ®ÿ∑Ÿáÿß ÿ®ÿßŸÑÿ®ÿßŸÉ-ÿ•ŸÜÿØ ŸÑÿßÿ≠ŸÇÿßŸã.`
            )
          )
        )
      }

      // Mount
      function mount() {
        try {
          const rootNode = document.getElementById('root');
          const root = ReactDOM.createRoot(rootNode);
          root.render(React.createElement(App));
        } catch (err) {
          const el = document.getElementById('boot-error') || (() => {
            const b = document.createElement('div');
            b.id = 'boot-error';
            b.style.cssText = 'position:fixed;left:1rem;right:1rem;bottom:1rem;background:#fee2e2;color:#7f1d1d;border:1px solid #fecaca;padding:.75rem 1rem;border-radius:.75rem;font:12px system-ui,-apple-system,Segoe UI,Roboto;z-index:99999;';
            document.body.appendChild(b); return b;
          })();
          el.textContent = 'Mount error: ' + err.message;
        }
      }

      if (document.readyState === 'complete' || document.readyState === 'interactive') {
        mount();
      } else {
        document.addEventListener('DOMContentLoaded', mount);
      }
    })();
  </script>
</body>
</html>
